services:
  server:
    environment:
      ENABLE_BUILTIN_BOT: "false"
      AGENT_WEBHOOK_URL: ${AGENT_WEBHOOK_URL}
      AGENT_TIMEOUT_MS: ${AGENT_TIMEOUT_MS:-30000}
      API_BASE_URL: ${API_BASE_URL}
      LOG_LEVEL: ${LOG_LEVEL:-info}
      NODE_ENV: ${NODE_ENV:-production}
      FEISHU_ENCRYPT_KEY: ${FEISHU_ENCRYPT_KEY}

  web:
    build:
      context: ./packages/web
      dockerfile: Dockerfile
    container_name: rabbit-lark-web
    restart: unless-stopped
    depends_on:
      - server
    environment:
      NEXT_PUBLIC_API_URL: http://server:3456/api
    ports:
      - "3000:3000"
